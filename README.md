# LLM-Backed Log Summarizer and Alert Responder

An intelligent log monitoring system that uses Large Language Models (LLMs) to analyze system logs, detect anomalies, and execute automated remediation actions via Model Context Protocol (MCP).

---

## üìã Description

This project implements an end-to-end log monitoring and incident response system that combines the power of Large Language Models with practical automation. The system continuously monitors log files (such as web server logs, syslog, or application logs), detects anomalies using pattern matching, analyzes incidents using LLM technology, and can automatically execute remediation actions through secure Bash scripts.

**What makes this system special:**
- **Intelligent Analysis**: Uses LLM to understand log context and provide meaningful summaries
- **Safe Automation**: All actions go through approval gates and validation via Model Context Protocol
- **Query Interface**: Ask questions about logs in natural language ("What errors occurred in the last hour?")
- **Automated Alert Rules**: System suggests and generates monitoring rules based on observed patterns
- **Complete Audit Trail**: Every action is logged for security and compliance

---

## üéØ Background

System administrators and DevOps engineers face the challenge of monitoring vast amounts of log data generated by modern systems. Traditional log analysis tools require complex rule configuration and struggle with:
- Multiple log formats across different services
- Understanding context and relationships between log entries
- Rapidly responding to incidents
- Scaling manual analysis

This project addresses these challenges by:
1. Using LLMs to understand log semantics and context
2. Providing natural language interfaces for querying logs
3. Automating remediation actions through safe, validated scripts
4. Offering real-time monitoring with intelligent anomaly detection

**Research Foundation:**
The implementation draws from research in log analysis (DeepLog, LogAnomaly), LLM agent systems (ReAct, Toolformer), and safety frameworks (Model Context Protocol). While the current implementation uses simplified pattern-based detection, the architecture supports future enhancements such as vector embeddings and advanced template mining.

---

## üìê Scope

### What This System Does:

‚úÖ **Log Ingestion**: Continuously monitors log files in real-time using streaming (similar to `tail -f`)  
‚úÖ **Anomaly Detection**: Detects errors, critical events, failures, and timeouts using configurable patterns  
‚úÖ **LLM Analysis**: Uses OpenRouter API to analyze log context and generate intelligent summaries  
‚úÖ **Query Interface**: Allows natural language queries about historical logs ("summarize last hour's errors")  
‚úÖ **Time Windows**: Query logs by time ranges (last hour, last 24 hours, custom periods)  
‚úÖ **Alert Rule Generation**: Automatically suggests and generates Bash scripts for alert rules  
‚úÖ **Automated Remediation**: Executes Bash scripts to fix issues (restart services, clear cache, etc.)  
‚úÖ **Safety Controls**: Approval gates, dry-run mode, and comprehensive audit logging  
‚úÖ **Metrics Tracking**: Calculates Mean Time To Detect (MTTD) and Mean Time To Recover (MTTR)  
‚úÖ **Evaluation Framework**: Measures system performance (latency, accuracy, false positives)  

### What This System Does NOT Do:

‚ùå **Vector Embeddings**: Not implemented (architecture supports as future enhancement)  
‚ùå **Template Mining**: No automatic log template extraction algorithms (Drain/Spell)  
‚ùå **RAG Pipeline**: Uses direct LLM calls, not retrieval-augmented generation  
‚ùå **Machine Learning Models**: Uses pattern-based detection, not trained ML models  
‚ùå **Real-Time Vector Search**: Uses SQLite relational queries, not semantic similarity search  

---

## ‚ú® Features and Capabilities

### Core Features

1. **Real-Time Log Monitoring**
   - Streams logs using `tail -F` (Linux) or similar methods
   - Detects anomalies using configurable keyword patterns
   - Stores all incidents in SQLite database

2. **LLM-Powered Analysis**
   - Uses OpenRouter API (supports GPT-3.5-turbo, GPT-4, and other models)
   - Generates intelligent summaries of log incidents
   - Suggests appropriate remediation actions
   - Returns structured JSON responses

3. **Query Interface**
   - Natural language queries: "summarize last hour's errors"
   - Time-window queries: "what happened in the last 24 hours?"
   - Pattern searches: "find suspicious authentication events"
   - Service-specific queries: "should I restart apache?"

4. **Alert Rule Generation**
   - Analyzes log patterns to suggest alert rules
   - Generates regex patterns automatically
   - Suggests thresholds based on frequency
   - Creates Bash scripts for alert monitoring

5. **MCP Framework (Model Context Protocol)**
   - Validates all tool invocations
   - Ensures actions match defined schemas
   - Provides audit trail for all operations
   - Enables safe automation

6. **Safety Features**
   - **Approval Gates**: High-risk actions require human approval
   - **Dry-Run Mode**: Test actions without actual execution
   - **Audit Logging**: Complete trail of all actions
   - **Risk Levels**: Actions classified as HIGH/MEDIUM/LOW risk

7. **Database Persistence**
   - SQLite database stores all incidents, actions, and logs
   - Time-window queries for historical analysis
   - Pattern-based search capabilities
   - Relational indexing for fast queries

8. **Metrics and Evaluation**
   - MTTD (Mean Time To Detect): How quickly incidents are identified
   - MTTR (Mean Time To Recover): How quickly incidents are resolved
   - Latency metrics: LLM API response times
   - Detection accuracy: Precision, recall, false positives

### Technical Capabilities

- **Language**: Python 3.7+, Bash scripting
- **Database**: SQLite (lightweight, file-based)
- **API Integration**: OpenRouter API (multi-model LLM access)
- **Protocol**: Model Context Protocol (MCP) for tool safety
- **Platform**: Linux/Unix (tested on WSL Windows)

---

## üöÄ Quick Start

### Prerequisites
- Python 3.7+
- OpenRouter API key (https://openrouter.ai)
- Linux/Unix environment (tested on WSL Windows)

### Setup
```bash
# Install dependencies
pip3 install -r requirements.txt

# Initialize database
python3 database.py

# Set API key (optional - fallback key available)
export OPENROUTER_API_KEY="your-key-here"
```

### Usage Examples

**Query Interface:**
```bash
python3 cli_interface.py query "summarize last hour errors"
python3 cli_interface.py query "should I restart apache"
```

**Alert Rule Generation:**
```bash
python3 cli_interface.py suggest-rules
```

**Live Monitoring:**
```bash
bash monitor.sh
```

**Metrics & Evaluation:**
```bash
python3 metrics.py
python3 cli_interface.py evaluate
```

---

## üéì Key Features

### System Architecture
- Real-time log ingestion and pattern-based anomaly detection
- LLM-powered analysis with OpenRouter API
- MCP (Model Context Protocol) for safe tool invocation
- SQLite database for persistent storage
- Approval gates and dry-run mode for safety

### Research Foundation
This implementation draws from research in:
- Log analysis (DeepLog, LogAnomaly, LogBERT)
- LLM agent systems (ReAct, Toolformer, AutoGen)
- Safety frameworks (Model Context Protocol)

The architecture prioritizes simplicity and production-readiness while maintaining research grounding. Advanced techniques (vector embeddings, template mining, RAG) are identified as future enhancements.

---

## üìö Additional Resources

- **LLM_BACKED_LOG_SUMMARIZER.pdf** - Literature review and research foundation
- **Project Code** - All source files are documented with comments

---

## ü§ù Questions During Demo?

**Q: Why use pattern-based detection instead of ML?**
A: Simplicity and reliability. Pattern-based detection is production-ready and easy to maintain. ML-based detection (like DeepLog) can be added as future enhancement.

**Q: Where are vector embeddings?**
A: The architecture supports vector embeddings, but the current implementation uses SQLite for faster deployment. Vector embeddings (SBERT/Faiss) are identified as future enhancement.

**Q: How does this compare to commercial SIEM tools?**
A: This system focuses on LLM-powered analysis and natural language interfaces, which many SIEM tools lack. It's designed to complement existing tools by adding intelligent analysis.

**Q: Is this production-ready?**
A: The core functionality is production-ready. Additional features (vector embeddings, template mining) can be added incrementally. The safety framework (MCP, approval gates) ensures safe operation.

---

## üìÑ License

[Add your license information here]

## üë• Authors

Zakariae Khmies, Mariam Chajia, Mohamed-yahia Ghounbaz, Nizar Abou-otmane  
Faculty of Computer Science, WSM Warsaw, Poland
